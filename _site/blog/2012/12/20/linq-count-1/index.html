
<!DOCTYPE html>
<html lang="ZH-CN">
  <head>
    <meta charset="utf-8">
    <title>从LINQ的Count方法说起-1</title>
    <meta name="description" content="从LINQ的Count方法说起-1">
    <meta name="author" content="NanQi">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/twitter/css/docs.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="/">南琦的博客</a>
          <ul class="nav">
            
            
            


  
    
      
      	
      	<li>
            <a href="/archive.html">
                Archive
                
            </a>
        </li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li>
            <a href="/categories.html">
                Category
                
            </a>
        </li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li>
            <a href="/logo.html">
                Logo
                
            </a>
        </li>
      	
      
    
  
    
      
      	
      	<li>
            <a href="/pages.html">
                Pages
                
            </a>
        </li>
      	
      
    
  
    
      
      	
      	<li>
            <a href="/Questions.html">
                Questions
                
            </a>
        </li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li>
            <a href="/tags.html">
                Tags
                
            </a>
        </li>
      	
      
    
  



          </ul>
        </div>
      </div>
    </div>
    <div class="container">
      <div class="content">
        
<?xml version="1.0" encoding="utf-8"?>
<div class="page-header">
  <h1>从LINQ的Count方法说起-1</h1>
</div>

<div class="row">
  <div class="span8">
    <div id="divPost"><h2>几句闲扯</h2>

<hr />

<p>在我学习LINQ时，确实感觉很爽。<br/>
但是时间久了，慢慢也就不那么在意了。但是周围朋友总是记得<code>我会使用LINQ</code>编程。<br/>
记得初中时候学几何，有一个已知三角形边长求面积的题，而我正巧知道<a href="http://baike.baidu.com/view/1279.htm">海伦公式</a>，之后凡是碰到可以使用此公式的题，同学都想起我会做，仿佛那公式应该以我的名字命名一样……<br/>
某人问我有没有学习LINQ的资料，我实在说不出，因为我从来都没有系统的去学过LINQ。我基本只是使用几个IEnumerable<T>的扩展方法，要说学习也只是从某些第X版书中读过几句，平时也就在一个集合点一下然后看看各自说明。<br/>
当然，LINQ不止于此，我也说不出到底LINQ都包含什么，什么是LINQ。</p>

<blockquote><p>给一个东西，一门技术下定义，从来都不是一件简单的事。</p></blockquote>

<h2>事出有因</h2>

<hr />

<p>事情是这样的，今天有人问我一个小问题，关于LINQ，然后我不经意间看到一行代码：</p>

<pre><code>int count = lst.Where(ch =&gt; char.IsNumber(ch)).Count();
</code></pre>

<p>代码读起来很简单，就是从一个char集合里找出为数字的个数。<br/>
代码没问题，但是还有个更好的写法：</p>

<pre><code>int count = lst.Count(char.IsNumber);
</code></pre>

<p>即便他不知道Count方法可以传参，那么他为什么不写成：</p>

<pre><code>int count = lst.Where(char.IsNumber).Count();
</code></pre>

<p>我相信他根本就不知道这里为什么要写ch => char.IsNumber(ch)，根本就不知道这里需要的是一个方法。<br/>
这让我想起一个男同事说一个女同事（所谓同事，都是程序猿），女的刚毕业，不怎么会，然后男的说女的写代码ToString不带括号。<br/>
这姑且说是这个女同事不知道调用方法即使没有参数也需要带括号，或者说她根本就不知道ToString是一个方法，但是同样也说明这个男同事以为方法只能去调用（call）。<br/>
或许简单下面的代码他会觉得很惊讶：</p>

<pre><code>string[] arr = lst.Where(char.IsNumber).Select(char.ToString);
</code></pre>

<p>又或者在事件上：</p>

<pre><code>delegate string GetNumberDelegate(char ch);
event GetNumberDelegate GetNumberEvent;
...
this.GetNumberEvent += char.ToString;
</code></pre>

<h2>几点思考</h2>

<hr />

<p>我想大多数人习惯于使用ch => char.IsNumber(ch)是因为这样感觉很好理解，程序可以<code>读出来</code>。是的，写LINQ最爽的一点就是这里了。<br/>
比如说使用Where方法，知道集合是一个char集合，那么ch很自然的可以当做char集合中每个元素，=>之后写下对每个元素的判断，很好理解，用起来很舒服。<br/>
但是切莫执迷于表像而偏离本质。<br/>
说起函数当做参数传递，记起曾经在封装一个日历控件的时候遇到一个问题：需要在已提交报表、未提交报表和还没到的日子分颜色：</p>

<p><img src="/image/ucCalendar.gif" alt="日历控件" /></p>

<p>但是关于颜色问题，修改了好多次，最后干脆我给封装的控件增加一个Func&lt;string, Color>，根据给定的类型（提交或未提交）去给定颜色。<br/>
最后我要说的是我本来初衷不是写好多人不知道<code>函数也是一个对象</code>，不知道函数也可以去传递，但是写一下给写跑题了，干脆就继续写下去。而原本我是想说说几个LINQ扩展方法的先后问题，留在下一篇博客中说吧。</p>
</div>
    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/blog/2012/12/16/unmain" title="其实根本不用混淆你的代码">&larr; 上一页</a></li>
      
        <li><a href="/archive.html">列表</a></li>
      
        <li class="next"><a href="/blog/2012/12/22/linq-count-2" title="从LINQ的Count方法说起-2">下一页 &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'nanqi'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
  <div class="span4">
    <h4>Published</h4>
    <div class="date"><span>2012-12-20</span>
  </div>

  
    <h4>Tags</h4>
    <ul class="tag_box">
    
    


  
     
    	<li><a href="/tags.html#C#-ref">C# <span>6</span></a></li>
     
    	<li><a href="/tags.html#LINQ-ref">LINQ <span>3</span></a></li>
    
  



    </ul>
  
  </div>
</div>


      </div>

      <footer>
        <p>&copy; NanQi 2012 - 2013
          参考 <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          和 <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
          源码托管在 <a href="https://github.com/nanqi">NanQi Github</a> 版权声明 <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/">CC BY-NC-SA 3.0</a>
          <script src="http://s95.cnzz.com/stat.php?id=4758074&web_id=4758074" language="JavaScript"></script>
        </p>
      </footer>

    <script src="/assets/themes/twitter/js/jquery.js"></script>
    </div> <!-- /container -->

    
  </body>
</html>

